<!doctype html>
<html>
  <head>
    <title>XML Practice</title>
  </head>
  <body>
    <h1>Existing Page</h1>

    <div id="store"></div>
    <script type="text/javascript">
      document.addEventListener('DOMContentLoaded', () => {
      let request = new XMLHttpRequest();
      let store = document.getElementById('store');

      request.open('GET', "https://ls-230-web-store-demo.herokuapp.com/products");

      request.addEventListener('load', event => {
        store.innerHTML = request.response;
      });

      request.send();

      store.addEventListener('click', event => {
        let target = event.target;

        if (target.tagName !== 'A') {
          return;
        }

        event.preventDefault();

        let request = new XMLHttpRequest();
        request.open('GET', "https://ls-230-web-store-demo.herokuapp.com" + target.getAttribute('href'));

        request.addEventListener('load', event => (store.innerHTML = request.response));
        request.send();
      });

      store.addEventListener('submit', event => {
        event.preventDefault();
        let form = event.target;
        let request = new XMLHttpRequest();
        let data = new FormData(form);

        request.open(form.method, `https://ls-230-web-store-demo.herokuapp.com${form.getAttribute('action')}`);
        request.addEventListener('load', event => {
          store.innerHTML = request.response;
        });

        request.send(data);
      });
    });
    </script>
  </body>
</html>